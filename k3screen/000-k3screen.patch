diff -Nuar a/src/infocenter.c b/src/infocenter.c
--- a/src/infocenter.c	2017-05-02 19:49:08.000000000 +0800
+++ b/src/infocenter.c	2021-12-29 17:37:00.837529076 +0800
@@ -116,9 +116,10 @@
      * be malformatted and the results are not reliable.
      */
     const char *stopped_at = tokenize_and_store(out, '\n', stores, store_len);
+    int ret = *stopped_at == 0 ? SUCCESS : FAILURE;
+    
     free((void *)out);
-
-    return *stopped_at == 0 ? SUCCESS : FAILURE;
+    return ret;
 }
 
 BASIC_INFO g_basic_info;
@@ -293,4 +294,4 @@
     print_wan_info(&g_wan_info);
     print_port_info(&g_port_info);
     print_host_info(g_host_info_array, g_host_info_elements);
-}
\ No newline at end of file
+}
